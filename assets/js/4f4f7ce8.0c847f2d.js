"use strict";(self.webpackChunkeventmesh_site=self.webpackChunkeventmesh_site||[]).push([[9946],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),h=r,d=c["".concat(s,".").concat(h)]||c[h]||m[h]||o;return n?a.createElement(d,i(i({ref:t},p),{},{components:n})):a.createElement(d,i({ref:t},p))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7143:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var a=n(87462),r=(n(67294),n(3905));const o={},i="EventMesh Runtime with Docker",l={unversionedId:"instruction/runtime-with-docker",id:"version-v1.11.0/instruction/runtime-with-docker",title:"EventMesh Runtime with Docker",description:"You can deploy EventMesh Runtime using Docker. This document provides an example of deploying it with RocketMQ as Event Store, but you can also choose another Event Store supported by EventMesh.",source:"@site/versioned_docs/version-v1.11.0/instruction/04-runtime-with-docker.md",sourceDirName:"instruction",slug:"/instruction/runtime-with-docker",permalink:"/docs/instruction/runtime-with-docker",draft:!1,editUrl:"https://github.com/apache/eventmesh-site/edit/master/versioned_docs/version-v1.11.0/instruction/04-runtime-with-docker.md",tags:[],version:"v1.11.0",sidebarPosition:4,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"EventMesh Runtime Quick Start",permalink:"/docs/instruction/runtime"},next:{title:"Run Java SDK Demo",permalink:"/docs/instruction/demo"}},s={},u=[{value:"1. Prerequisites",id:"1-prerequisites",level:2},{value:"2. Pull the EventMesh Runtime Image",id:"2-pull-the-eventmesh-runtime-image",level:2},{value:"3. Mount Configuration Files",id:"3-mount-configuration-files",level:2},{value:"3.1 EventMesh Runtime Configuration",id:"31-eventmesh-runtime-configuration",level:3},{value:"3.2 Event Store Configuration",id:"32-event-store-configuration",level:3},{value:"4. Run the EventMesh Runtime Container",id:"4-run-the-eventmesh-runtime-container",level:2},{value:"5. View EventMesh Logs",id:"5-view-eventmesh-logs",level:2},{value:"6. Build EventMesh Runtime Image (Optional)",id:"6-build-eventmesh-runtime-image-optional",level:2}],p={toc:u},c="wrapper";function m(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"eventmesh-runtime-with-docker"},"EventMesh Runtime with Docker"),(0,r.kt)("p",null,"You can deploy EventMesh Runtime using Docker. This document provides an example of deploying it with RocketMQ as Event Store, but you can also choose another ",(0,r.kt)("a",{parentName:"p",href:"/docs/roadmap#event-store-implementation-status"},"Event Store supported by EventMesh"),"."),(0,r.kt)("h2",{id:"1-prerequisites"},"1. Prerequisites"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"It is recommended to use a 64-bit Linux system."),(0,r.kt)("li",{parentName:"ol"},"Ensure Docker Engine is installed. Refer to the ",(0,r.kt)("a",{parentName:"li",href:"https://docs.docker.com/engine/install/"},"official Docker documentation")," for the installation process."),(0,r.kt)("li",{parentName:"ol"},"Familiarity with basic Docker concepts and command-line operations (e.g., registry, mounting) is recommended but not mandatory, as the required commands are provided."),(0,r.kt)("li",{parentName:"ol"},"If you choose a non-standalone mode, ensure that ",(0,r.kt)("a",{parentName:"li",href:"https://rocketmq.apache.org/docs/quick-start/"},"RocketMQ is successfully started")," and accessible via IP address. If you stick to the default standalone mode, RocketMQ doesn't need to be deployed.")),(0,r.kt)("h2",{id:"2-pull-the-eventmesh-runtime-image"},"2. Pull the EventMesh Runtime Image"),(0,r.kt)("p",null,"First, open a command line and use the following ",(0,r.kt)("inlineCode",{parentName:"p"},"pull")," command to download the ",(0,r.kt)("a",{parentName:"p",href:"https://eventmesh.apache.org/events/release-notes/"},"latest version of EventMesh")," from ",(0,r.kt)("a",{parentName:"p",href:"https://hub.docker.com/r/apache/eventmesh/tags"},"Docker Hub"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo docker pull apache/eventmesh:latest\n")),(0,r.kt)("p",null,"You can use the following command to list and view the locally available images."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo docker images\n")),(0,r.kt)("p",null,"If the terminal displays image information similar to the following, it indicates that the EventMesh image has been successfully downloaded locally."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ sudo docker images\nREPOSITORY         TAG       IMAGE ID       CREATED      SIZE\napache/eventmesh   latest    f32f9e5e4694   2 days ago   917MB\n")),(0,r.kt)("h2",{id:"3-mount-configuration-files"},"3. Mount Configuration Files"),(0,r.kt)("p",null,"If you are starting EventMesh Runtime in standalone mode and haven't customized the configuration, you can proceed to the next step."),(0,r.kt)("p",null,"First, create the EventMesh configuration file directory on the host machine. This directory can be freely specified:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo mkdir -p /data/eventmesh/conf\ncd /data/eventmesh/conf\n")),(0,r.kt)("h3",{id:"31-eventmesh-runtime-configuration"},"3.1 EventMesh Runtime Configuration"),(0,r.kt)("p",null,"This configuration file includes parameters required for the EventMesh Runtime environment and integration with other plugins."),(0,r.kt)("p",null,"Download the configuration file (replace ",(0,r.kt)("inlineCode",{parentName:"p"},"1.10.0")," in the download link with the version you are using):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo wget https://raw.githubusercontent.com/apache/eventmesh/1.10.0-prepare/eventmesh-runtime/conf/eventmesh.properties\n")),(0,r.kt)("p",null,"Edit ",(0,r.kt)("inlineCode",{parentName:"p"},"eventmesh.properties"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo vim eventmesh.properties\n")),(0,r.kt)("p",null,"Specify RocketMQ as Event Store:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-properties"},"# storage plugin\neventMesh.storage.plugin.type=rocketmq\n")),(0,r.kt)("p",null,"Check if the default ports in the configuration file are occupied. If occupied, modify them to unused ports:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Default"),(0,r.kt)("th",{parentName:"tr",align:null},"Remarks"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"eventMesh.server.tcp.port"),(0,r.kt)("td",{parentName:"tr",align:null},"10000"),(0,r.kt)("td",{parentName:"tr",align:null},"TCP listening port")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"eventMesh.server.http.port"),(0,r.kt)("td",{parentName:"tr",align:null},"10105"),(0,r.kt)("td",{parentName:"tr",align:null},"HTTP listening port")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"eventMesh.server.grpc.port"),(0,r.kt)("td",{parentName:"tr",align:null},"10205"),(0,r.kt)("td",{parentName:"tr",align:null},"gRPC listening port")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"eventMesh.server.admin.http.port"),(0,r.kt)("td",{parentName:"tr",align:null},"10106"),(0,r.kt)("td",{parentName:"tr",align:null},"HTTP management port")))),(0,r.kt)("h3",{id:"32-event-store-configuration"},"3.2 Event Store Configuration"),(0,r.kt)("p",null,"In the case of RocketMQ, the configuration file includes parameters required to connect to the RocketMQ namesrv."),(0,r.kt)("p",null,"Download the configuration file (replace ",(0,r.kt)("inlineCode",{parentName:"p"},"1.10.0")," in the download link with the version you are using):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo wget https://raw.githubusercontent.com/apache/eventmesh/1.10.0-prepare/eventmesh-storage-plugin/eventmesh-storage-rocketmq/src/main/resources/rocketmq-client.properties\n")),(0,r.kt)("p",null,"Edit ",(0,r.kt)("inlineCode",{parentName:"p"},"rocketmq-client.properties"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo vim rocketmq-client.properties\n")),(0,r.kt)("p",null,"If the namesrv address you are running is different from the default value in the configuration file, modify it to the actual running namesrv address."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Default"),(0,r.kt)("th",{parentName:"tr",align:null},"Remarks"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"eventMesh.server.rocketmq.namesrvAddr"),(0,r.kt)("td",{parentName:"tr",align:null},"127.0.0.1:9876;127.0.0.1:9876"),(0,r.kt)("td",{parentName:"tr",align:null},"RocketMQ namesrv address")))),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"If you are unable to download the configuration files using the provided links, you can find all the configuration files in the ",(0,r.kt)("inlineCode",{parentName:"p"},"conf")," path of the EventMesh binary distribution.")),(0,r.kt)("h2",{id:"4-run-the-eventmesh-runtime-container"},"4. Run the EventMesh Runtime Container"),(0,r.kt)("p",null,"Use the following command to start the EventMesh container:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo docker run -d --name eventmesh -p 10000:10000 -p 10105:10105 -p 10205:10205 -p 10106:10106 -v /data/eventmesh/conf/eventmesh.properties:/data/app/eventmesh/conf/eventmesh.properties -v /data/eventmesh/conf/rocketmq-client.properties:/data/app/eventmesh/conf/rocketmq-client.properties -t apache/eventmesh:latest\n")),(0,r.kt)("p",null,"Explanation of ",(0,r.kt)("inlineCode",{parentName:"p"},"docker run")," command parameters:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"-p <host port>:<container port>"),": Bind the container port to the host port. If you modified the default ports in EventMesh Runtime configuration or if the host's ports are already occupied, modify them accordingly."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"-v <host path>:<container path>"),": Mount the configuration files from the host to the container. If the path where you store EventMesh configuration files is not ",(0,r.kt)("inlineCode",{parentName:"li"},"/data/eventmesh/conf"),", modify the host path accordingly. If you haven't customized the configuration files, please remove this parameter."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--name eventmesh"),": Custom name for the container. This name must be unique."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"-t apache/eventmesh:latest"),": Image used by the container.")),(0,r.kt)("p",null,"After executing the ",(0,r.kt)("inlineCode",{parentName:"p"},"docker run")," command, the container ID will be returned. Use the following command to view the status of all running containers:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo docker ps\n")),(0,r.kt)("p",null,"It will print:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'CONTAINER ID   IMAGE                      COMMAND               CREATED          STATUS         PORTS                                                                                                                                                                 NAMES\nb7a1546ee96a   apache/eventmesh:latest   "bash bin/start.sh"   10 seconds ago   Up 8 seconds   0.0.0.0:10000->10000/tcp, :::10000->10000/tcp, 0.0.0.0:10105-10106->10105-10106/tcp, :::10105-10106->10105-10106/tcp, 0.0.0.0:10205->10205/tcp, :::10205->10205/tcp   eventmesh\n')),(0,r.kt)("p",null,"If the EventMesh Runtime container is not in the list printed by this command, it means the container failed to start. You can use the following command to view the logs at the time of startup (replace ",(0,r.kt)("inlineCode",{parentName:"p"},"eventmesh")," with the container name or ID you specified):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo docker logs eventmesh\n")),(0,r.kt)("h2",{id:"5-view-eventmesh-logs"},"5. View EventMesh Logs"),(0,r.kt)("p",null,"After successfully starting the EventMesh container, you can follow these steps to view the logs output by EventMesh and check the runtime status."),(0,r.kt)("p",null,"Enter the container (replace ",(0,r.kt)("inlineCode",{parentName:"p"},"eventmesh")," with the container name or ID you specified):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo docker exec -it eventmesh /bin/bash\n")),(0,r.kt)("p",null,"View the logs:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cd logs\ntail -n 50 -f eventmesh.out\n")),(0,r.kt)("p",null,"When the log output shows ",(0,r.kt)("inlineCode",{parentName:"p"},"server state:RUNNING"),", it means EventMesh Runtime has started successfully."),(0,r.kt)("h2",{id:"6-build-eventmesh-runtime-image-optional"},"6. Build EventMesh Runtime Image (Optional)"),(0,r.kt)("p",null,"EventMesh is developed based on JDK8. The binary distribution and container image are built based on JDK8 and are also compatible with JDK11."),(0,r.kt)("p",null,"To run the container in a JDK8 environment, execute the following command in the root directory of the EventMesh source code:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo docker build -t yourname/eventmesh:yourtag -f docker/Dockerfile_jdk8 .\n")),(0,r.kt)("p",null,"If you want to use JDK11 as the container's runtime environment, execute:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo docker build -t yourname/eventmesh:yourtag -f docker/Dockerfile_jdk11 .\n")))}m.isMDXComponent=!0}}]);