"use strict";(self.webpackChunkeventmesh_site=self.webpackChunkeventmesh_site||[]).push([[5725],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},h=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,h=o(e,["components","mdxType","originalType","parentName"]),c=p(n),u=r,m=c["".concat(l,".").concat(u)]||c[u]||d[u]||i;return n?a.createElement(m,s(s({ref:t},h),{},{components:n})):a.createElement(m,s({ref:t},h))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=u;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[c]="string"==typeof e?e:r,s[1]=o;for(var p=2;p<i;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},60027:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const i={title:"How to Release",sidebar_position:3},s="Apache publish guide",o={unversionedId:"release",id:"release",title:"How to Release",description:"Understand the content and process of Apache's release",source:"@site/community/04-release.md",sourceDirName:".",slug:"/release",permalink:"/community/release",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"How to Release",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Unit Test Requirement",permalink:"/community/contribute/write-unit-test"},next:{title:"How to Vote New Committer/PMC members",permalink:"/community/how-to-vote-a-committer-pmc"}},l={},p=[{value:"Understand the content and process of Apache&#39;s release",id:"understand-the-content-and-process-of-apaches-release",level:2},{value:"Tool preparation",id:"tool-preparation",level:2},{value:"1. Install GPG",id:"1-install-gpg",level:3},{value:"2. Generate key with gpg",id:"2-generate-key-with-gpg",level:3},{value:"3. Check the key",id:"3-check-the-key",level:3},{value:"Publish to the Apache Maven repository",id:"publish-to-the-apache-maven-repository",level:2},{value:"1. Export private key file",id:"1-export-private-key-file",level:3},{value:"2. Prepare branch",id:"2-prepare-branch",level:3},{value:"3. Update the release note",id:"3-update-the-release-note",level:3},{value:"4. Configure the gradle.properties file under the root project",id:"4-configure-the-gradleproperties-file-under-the-root-project",level:3},{value:"5. Check the gradle.properties file under the submodule",id:"5-check-the-gradleproperties-file-under-the-submodule",level:3},{value:"6. Check and configure the build.gradle file under the root project",id:"6-check-and-configure-the-buildgradle-file-under-the-root-project",level:3},{value:"7. Upload release package",id:"7-upload-release-package",level:3},{value:"Publish to the Apache SVN repository",id:"publish-to-the-apache-svn-repository",level:2},{value:"1. Prepare the svn native environment (Apache uses svn to host the published content of the project)",id:"1-prepare-the-svn-native-environment-apache-uses-svn-to-host-the-published-content-of-the-project",level:3},{value:"2. Checkout to local directory",id:"2-checkout-to-local-directory",level:3},{value:"3. Add gpg public key",id:"3-add-gpg-public-key",level:3},{value:"4. Add packages to be published to the SVN directory",id:"4-add-packages-to-be-published-to-the-svn-directory",level:3},{value:"4.1 Create tags",id:"41-create-tags",level:4},{value:"4.2 Package source code",id:"42-package-source-code",level:4},{value:"4.3 Build binary package",id:"43-build-binary-package",level:4},{value:"5. Generate signature/sha512 file",id:"5-generate-signaturesha512-file",level:3},{value:"6. Commit to Apache SVN",id:"6-commit-to-apache-svn",level:3},{value:"Verify Release Candidates",id:"verify-release-candidates",level:2},{value:"1. Check information such as signature and hash",id:"1-check-information-such-as-signature-and-hash",level:3},{value:"1.1 Check the sha512 hash",id:"11-check-the-sha512-hash",level:4},{value:"1.2 Check gpg signature",id:"12-check-gpg-signature",level:4},{value:"2. Check the file content of the source package",id:"2-check-the-file-content-of-the-source-package",level:3},{value:"3. Check the file content of the binary package",id:"3-check-the-file-content-of-the-binary-package",level:3},{value:"Initiates a vote",id:"initiates-a-vote",level:2},{value:"1. EventMesh community voting stage",id:"1-eventmesh-community-voting-stage",level:3},{value:"2. EventMesh community voting template",id:"2-eventmesh-community-voting-template",level:3},{value:"3. Announcing voting results template",id:"3-announcing-voting-results-template",level:3},{value:"Official release",id:"official-release",level:2},{value:"1. Merging code branch",id:"1-merging-code-branch",level:3},{value:"2. Migrating source and binary packages",id:"2-migrating-source-and-binary-packages",level:3},{value:"3. Confirm that the packages under dev and release are correct",id:"3-confirm-that-the-packages-under-dev-and-release-are-correct",level:3},{value:"4. Publish releases in the Apache Staging repository",id:"4-publish-releases-in-the-apache-staging-repository",level:3},{value:"5. GitHub version release",id:"5-github-version-release",level:3},{value:"6. Update download page",id:"6-update-download-page",level:3},{value:"7. Announce version is released",id:"7-announce-version-is-released",level:3}],h={toc:p},c="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"apache-publish-guide"},"Apache publish guide"),(0,r.kt)("h2",{id:"understand-the-content-and-process-of-apaches-release"},"Understand the content and process of Apache's release"),(0,r.kt)("p",null,"Source Release is the focus of Apache\u2019s attention and is also a required content for release; Binary Release is optional. Please refer to the following link to find more ASF release guidelines:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://www.apache.org/dev/release-publishing"},"Apache Release Guide")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://www.apache.org/dev/release.html"},"Apache Release Policy")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"http://www.apache.org/dev/publishing-maven-artifacts.html"},"Maven Release Info"))),(0,r.kt)("h2",{id:"tool-preparation"},"Tool preparation"),(0,r.kt)("p",null,"Mainly include the preparation of the signature tool GnuPG, Maven repository certification"),(0,r.kt)("h3",{id:"1-install-gpg"},"1. Install GPG"),(0,r.kt)("p",null,"Download the binary installation package (GnuPG binary releases) at ",(0,r.kt)("a",{parentName:"p",href:"https://www.gnupg.org/download/index.html"},"GnuPG official website"),". The commands of GnuPG 1.x version and 2.x version are slightly different. The following description takes ",(0,r.kt)("strong",{parentName:"p"},"GnuPG-2.x")," version as example."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"$ gpg --version #Check the version, it should be 2.x\n")),(0,r.kt)("h3",{id:"2-generate-key-with-gpg"},"2. Generate key with gpg"),(0,r.kt)("p",null,"According to the prompt, generate the key"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note\uff1aplease use Apache mail box generate GPG Key")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'$ gpg --full-gen-key\ngpg (GnuPG) 2.0.12; Copyright (C) 2009 Free Software Foundation, Inc.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\nPlease select what kind of key you want:\n  (1) RSA and RSA (default)\n  (2) DSA and Elgamal\n  (3) DSA (sign only)\n  (4) RSA (sign only)\nYour selection? 1\nRSA keys may be between 1024 and 4096 bits long.\nWhat keysize do you want? (2048) 4096\nRequested keysize is 4096 bits\nPlease specify how long the key should be valid.\n        0 = key does not expire\n     <n>  = key expires in n days\n     <n>w = key expires in n weeks\n     <n>m = key expires in n months\n     <n>y = key expires in n years\nKey is valid for? (0)\nKey does not expire at all\nIs this correct? (y/N) y\n\nGnuPG needs to construct a user ID to identify your key.\n\nReal name: ${please enter the username}\nEmail address: ${enter the email address}\nComment: CODE SIGNING KEY\nYou selected this USER-ID:\n   "${username} (CODE SIGNING KEY) <${email address}>"\n\nChange (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O\nYou need a Passphrase to protect your secret key. # enter the password for protecting your secret key\n')),(0,r.kt)("h3",{id:"3-check-the-key"},"3. Check the key"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ gpg --list-keys\npub   rsa4096/579C25F5 2021-04-26 # 579C25F5 is key id\nuid           [ultimate] ${username} <${email address}>\nsub   rsa4096 2021-04-26\n\n# upload the public key to keyserver with key id\n# Currently available in China: pgp.mit.edu, keyserver.ubuntu.com\n$ gpg --keyserver keyserver.ubuntu.com --send-key 579C25F5\n\n# keyserver.ubuntu.com is the corresponding keyserver, The keyserver list is: https://sks-keyservers.net/status/, which are automatically synchronized with each other, and you can choose any one.\n$ gpg --keyserver hkp://keyserver.ubuntu.com --recv-keys 579C25F5 # Verify whether it is synchronized to the public network. If the network is not good, you may need to try a few more times\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note: If there are multiple public keys, set the default key. "),"Modify ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.gnupg/gpg.conf")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"# If you have more than 1 secret key in your keyring, you may want to\n# uncomment the following option and set your preferred keyid.\ndefault-key 28681CB1\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"If there are multiple public keys, useless keys can also be deleted\uff1a")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ gpg --delete-secret-keys 29BBC3CB # first delete the private key and specify the key id\ngpg (GnuPG) 2.2.27; Copyright (C) 2021 g10 Code GmbH\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\nsec  rsa4096/EE8DAE7D29BBC3CB 2021-04-27 mikexue <mikexue@apache.org>\n\nDelete this key from the keyring? (y/N) y\nThis is a secret key! - really delete? (y/N) y\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ gpg --delete-keys 29BBC3CB # delete the public key, specify the key id\ngpg (GnuPG) 2.2.27; Copyright (C) 2021 g10 Code GmbH\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\n\npub  rsa4096/EE8DAE7D29BBC3CB 2021-04-27 mikexue <mikexue@apache.org>\n\nDelete this key from the keyring? (y/N) y\n")),(0,r.kt)("p",null,"Since the public key server has no checking mechanism, anyone can upload the public key in your name, so there is no way to guarantee the reliability of the public key on the server. Usually, you can publish a public key fingerprint on the website, so that others can check whether the downloaded public key is genuine."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# use fingerprint parameter generates a public key fingerprint:\n$gpg --fingerprint mikexue\npub   rsa4096 2021-04-26 [SCA]\n      F84A 0041 D70B 37AF 9C7B  F0B3 39F4 29D7 579C 25F5\nuid           [ultimate] mikexue <mikexue@apache.org>\nsub   rsa4096 2021-04-26 [E]\n")),(0,r.kt)("p",null,"Log in to  ",(0,r.kt)("a",{parentName:"p",href:"https://id.apache.org/"},"https://id.apache.org"),", paste the above fingerprint (ie F84A 0041 D70B 37AF 9C7B  F0B3 39F4 29D7 579C 25F5) into your user information OpenPGP Public Key Primary Fingerprint"),(0,r.kt)("h2",{id:"publish-to-the-apache-maven-repository"},"Publish to the Apache Maven repository"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note: EventMesh is built using Gradle, and gradle-related configuration needs to be modified")),(0,r.kt)("h3",{id:"1-export-private-key-file"},"1. Export private key file"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ gpg --export-secret-keys -o secring.gpg #the private key file is properly kept, and it is required for later configuration\n")),(0,r.kt)("h3",{id:"2-prepare-branch"},"2. Prepare branch"),(0,r.kt)("p",null,"Pull the new branch from the master branch as the release branch. If you want to release the $",(0,r.kt)("inlineCode",{parentName:"p"},"{release_version}")," version now, pull the new branch ",(0,r.kt)("inlineCode",{parentName:"p"},"${release_version}-prepare")," from the master branch, and then ",(0,r.kt)("inlineCode",{parentName:"p"},"${release_version}")," Release Candidates involves The modification and labeling of all files are carried out in the ",(0,r.kt)("inlineCode",{parentName:"p"},"${release_version}-prepare")," branch, and merged into the main branch after the final release is completed."),(0,r.kt)("h3",{id:"3-update-the-release-note"},"3. Update the release note"),(0,r.kt)("p",null,"Update the following files of the official website project and submit them to the master branch:"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/eventmesh-site/tree/master/events/release-notes"},"https://github.com/apache/eventmesh-site/tree/master/events/release-notes")),(0,r.kt)("h3",{id:"4-configure-the-gradleproperties-file-under-the-root-project"},"4. Configure the gradle.properties file under the root project"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"group=org.apache.eventmesh\nversion=1.2.0-release\n#the last 8 digits of the 40-digit public key\nsigning.keyId=579C25F5\n#the passphrase filled in when generating the key\nsigning.password=\n#the path of the exported private key file secring.gpg, absolute path, such as /home/root/secring.gpg\nsigning.secretKeyRingFile=/home/root/secring.gpg\n#apache account\napacheUserName=\n#apache password\napachePassWord=\n#sign switch\nsignEnabled=true\n")),(0,r.kt)("h3",{id:"5-check-the-gradleproperties-file-under-the-submodule"},"5. Check the gradle.properties file under the submodule"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"group=org.apache.eventmesh\nversion=${release_version}\n")),(0,r.kt)("h3",{id:"6-check-and-configure-the-buildgradle-file-under-the-root-project"},"6. Check and configure the build.gradle file under the root project"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"publishing {\n    publications {\n        mavenJava(MavenPublication) {\n            from components.java\n            artifact packageSources\n            artifact packageJavadoc\n            versionMapping {\n                usage('java-api') {\n                    fromResolutionOf('runtimeClasspath')\n                }\n                usage('java-runtime') {\n                    fromResolutionResult()\n                }\n            }\n            pom {\n                name = 'EventMesh'\n                description = 'Apache EventMesh'\n                url = 'https://github.com/apache/eventmesh'\n                licenses {\n                    license {\n                        name = 'The Apache License, Version 2.0'\n                        url = 'http://www.apache.org/licenses/LICENSE-2.0.txt'\n                    }\n                }\n                developers {\n                    developer {\n                        id = 'Apache EventMesh'\n                        name = 'Apache EventMesh of ASF'\n                        url = 'https://eventmesh.apache.org/'\n                    }\n                }\n                scm {\n                    connection = 'scm:git:git@github.com:apache/eventmesh.git'\n                    developerConnection = 'scm:git:git@github.com:apache/eventmesh.git'\n                    url = 'https://github.com/apache/eventmesh'\n                }\n            }\n        }\n    }\n    repositories {\n        maven {\n            def releasesRepoUrl = 'https://repository.apache.org/service/local/staging/deploy/maven2/'\n            def snapshotsRepoUrl = 'https://repository.apache.org/content/repositories/snapshots/'\n            url = version.endsWith('SNAPSHOT') ? snapshotsRepoUrl : releasesRepoUrl\n            credentials {\n                username apacheUserName\n                password apachePassWord\n            }\n\n        }\n    }\n}\n\nsigning {\n    sign publishing.publications.mavenJava\n}\n")),(0,r.kt)("h3",{id:"7-upload-release-package"},"7. Upload release package"),(0,r.kt)("p",null,"Execute the following command, you need to sign and encrypt files such as jar, source package, doc and pom"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ gradle signMavenJavaPublication publish\n")),(0,r.kt)("p",null,"After the above command is executed successfully, the version to be released will be automatically uploaded to Apache's staging repository. All Artifacts that are deployed to the remote ",(0,r.kt)("a",{parentName:"p",href:"http://repository.apache.org/"},"maven repository")," will be in the staging state\uff0cvisit ",(0,r.kt)("a",{parentName:"p",href:"https://repository.apache.org/#stagingRepositories"},"https://repository.apache.org/#stagingRepositories")," ,log in with Apache's LDAP account, You will see the uploaded version, and the content of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Repository")," column is ${STAGING.REPOSITORY}. Click ",(0,r.kt)("inlineCode",{parentName:"p"},"Close")," to tell Nexus that the build is complete and only then will the build be usable. If there is a problem with the electronic signature, ",(0,r.kt)("inlineCode",{parentName:"p"},"Close")," will fail, and you can view the failure information through ",(0,r.kt)("inlineCode",{parentName:"p"},"Activity"),"."),(0,r.kt)("h2",{id:"publish-to-the-apache-svn-repository"},"Publish to the Apache SVN repository"),(0,r.kt)("h3",{id:"1-prepare-the-svn-native-environment-apache-uses-svn-to-host-the-published-content-of-the-project"},"1. Prepare the svn native environment (Apache uses svn to host the published content of the project)"),(0,r.kt)("h3",{id:"2-checkout-to-local-directory"},"2. Checkout to local directory"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ svn checkout https://dist.apache.org/repos/dist/dev/eventmesh/\n# the local directory is assumed to be ~/apache/eventmesh\n")),(0,r.kt)("h3",{id:"3-add-gpg-public-key"},"3. Add gpg public key"),(0,r.kt)("p",null,"Add the public key to the ",(0,r.kt)("a",{parentName:"p",href:"https://dist.apache.org/repos/dist/dev/eventmesh/KEYS"},"KEYS")," file and submit it to the SVN warehouse (the first time the person who publishes needs to do this operation, specifically refer to the description in the KEYS file for operation). KEYS is mainly for voters to import locally to verify the correctness of sign"),(0,r.kt)("p",null,"Windows"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"$ gpg --list-sigs <your name> | out-file -append KEYS -encoding utf8\n$ gpg --armor --export <your name> | out-file -append KEYS -encoding utf8\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Mac OS/Linux")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"$ (gpg --list-sigs <your name> && gpg --armor --export <your name>) >> KEYS\n")),(0,r.kt)("h3",{id:"4-add-packages-to-be-published-to-the-svn-directory"},"4. Add packages to be published to the SVN directory"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ cd ~/apache/eventmesh # eventmesh svn root path\n$ mkdir ${release_version}-${rc_version}\n")),(0,r.kt)("h4",{id:"41-create-tags"},"4.1 Create tags"),(0,r.kt)("p",null,"Create a tag on ",(0,r.kt)("inlineCode",{parentName:"p"},"${release_version}-prepare")," branch, with rc version, which is a pre-release version"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'$ git tag -a v{$release_version}-{$rc_version} -m "Tagging the ${release_version} first Release Candidate (Candidates start at zero)"\n$ git push origin --tags\n')),(0,r.kt)("h4",{id:"42-package-source-code"},"4.2 Package source code"),(0,r.kt)("p",null,"Check the naming format of the project source package, name the source code ",(0,r.kt)("inlineCode",{parentName:"p"},"apache-eventmesh-${release_version}-src"),", and package it in tar.gz format"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ tar -czvf apache-eventmesh-${release_version}-source.tar.gz apache-eventmesh-${release_version}-src\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note: Make sure that there are no binary files in the source package, such as gradle-wrapper.jar, etc.")),(0,r.kt)("h4",{id:"43-build-binary-package"},"4.3 Build binary package"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Package the binary release on the ",(0,r.kt)("inlineCode",{parentName:"p"},"${release_version}-prepare")," branch.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note: The ",(0,r.kt)("inlineCode",{parentName:"p"},"dist")," task depends on ",(0,r.kt)("inlineCode",{parentName:"p"},"generateDistLicense")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"generateDistNotice")," tasks, which will automatically generate ",(0,r.kt)("inlineCode",{parentName:"p"},"LICENSE")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"NOTICE")," files under the ",(0,r.kt)("inlineCode",{parentName:"p"},"tools/dist-license")," directory. The ",(0,r.kt)("inlineCode",{parentName:"p"},"dist")," task itself will copy the contents from the ",(0,r.kt)("inlineCode",{parentName:"p"},"tools/dist-license")," directory to the ",(0,r.kt)("inlineCode",{parentName:"p"},"/dist")," directory.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ ./gradlew clean dist && ./gradlew installPlugin\n")),(0,r.kt)("p",null,"Check the compiled file naming, renaming the ",(0,r.kt)("inlineCode",{parentName:"p"},"/dist")," directory to ",(0,r.kt)("inlineCode",{parentName:"p"},"apache-eventmesh-${release_version}"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ tar -czvf apache-eventmesh-${release_version}-bin.tar.gz apache-eventmesh-${release_version}\n")),(0,r.kt)("p",null,"Compress the source package and the binary package, and copy the relevant compressed packages to the local SVN repository under ",(0,r.kt)("inlineCode",{parentName:"p"},"/apache/eventmesh/${release_version}-${rc_version}"),"."),(0,r.kt)("h3",{id:"5-generate-signaturesha512-file"},"5. Generate signature/sha512 file"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Generate signature/sha512 files for source and binary packages")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ for i in *.tar.gz; do echo $i; gpg --print-md SHA512 $i > $i.sha512 ; done #compute sha512\n$ for i in *.tar.gz; do echo $i; gpg --armor --output $i.asc --detach-sig $i ; done #compute signature\n")),(0,r.kt)("h3",{id:"6-commit-to-apache-svn"},"6. Commit to Apache SVN"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ cd ~/apache/eventmesh # eventmesh svn root directory\n$ svn status\n$ svn commit -m 'prepare for ${release_version}-${rc_version}'\n")),(0,r.kt)("h2",{id:"verify-release-candidates"},"Verify Release Candidates"),(0,r.kt)("p",null,"For a detailed check list, please refer to the official ",(0,r.kt)("a",{parentName:"p",href:"https://cwiki.apache.org/confluence/display/INCUBATOR/Incubator+Release+Checklist"},"check list")),(0,r.kt)("p",null,"Download the Release Candidates to be released to the local environment from the following address:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"https://dist.apache.org/repos/dist/dev/eventmesh/${release_version}-${rc_version}/\n")),(0,r.kt)("p",null,"Then start the verification link, which includes but is not limited to the following content and forms"),(0,r.kt)("h3",{id:"1-check-information-such-as-signature-and-hash"},"1. Check information such as signature and hash"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Due to different operating systems, the check command may be different. For details, please refer to ",(0,r.kt)("a",{parentName:"p",href:"https://www.apache.org/info/verification.html"},"Official Verification Steps"))),(0,r.kt)("h4",{id:"11-check-the-sha512-hash"},"1.1 Check the sha512 hash"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Mac OS/Linux")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ shasum -a apache-eventmesh-${release_version}-source.tar.gz\n#and compare the output with the contents of the apache-eventmesh-${release_version}-${rc_version}-source.tar.gz.sha512 file\n$ shasum -a apache-eventmesh-${release_version}-bin.tar.gz\n#and compare the output with the contents of the apache-eventmesh-${release_version}-${rc_version}-bin.tar.gz.sha512 file\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Windows")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ certUtil -hashfile apache-eventmesh-${release_version}-source.tar.gz SHA512\n#and compare the output with the contents of the apache-eventmesh-${release_version}-${rc_version}-source.tar.gz.sha512 file\n$ certUtil -hashfile apache-eventmesh-${release_version}-bin.tar.gz SHA512\n#and compare the output with the contents of the apache-eventmesh-${release_version}-${rc_version}-bin.tar.gz.sha512 file\n")),(0,r.kt)("h4",{id:"12-check-gpg-signature"},"1.2 Check gpg signature"),(0,r.kt)("p",null,"First import the release manager's public key. Import KEYS from the svn repository to the local environment. (The release manager does not need to import again, the person who helps to do the verification needs to import, and the user name can be filled with the user name of the release manager)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ curl https://dist.apache.org/repos/dist/dev/eventmesh/KEYS >> KEYS\n$ gpg --import KEYS\n$ gpg --edit-key \"${release manager gpg name}\"\n  > trust\n\nPlease decide how far you trust this user to correctly verify other users' keys\n(by looking at passports, checking fingerprints from different sources, etc.)\n\n  1 = I don't know or won't say\n  2 = I do NOT trust\n  3 = I trust marginally\n  4 = I trust fully\n  5 = I trust ultimately\n  m = back to the main menu\n\nYour decision? 5\n\n  > save\n")),(0,r.kt)("p",null,"Then check the signature with the following command"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ gpg --verify apache-eventmesh-${release_version}-source.tar.gz.asc apache-eventmesh-${release_version}-source.tar.gz\n$ gpg --verify apache-eventmesh-${release_version}-bin.tar.gz.asc apache-eventmesh-${release_version}-bin.tar.gz\n")),(0,r.kt)("h3",{id:"2-check-the-file-content-of-the-source-package"},"2. Check the file content of the source package"),(0,r.kt)("p",null,"Extract ",(0,r.kt)("inlineCode",{parentName:"p"},"apache-eventmesh-${release_version}-source.tar.gz")," and perform the following checks:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Check if the source package contains unnecessary files that make the tar package too large."),(0,r.kt)("li",{parentName:"ul"},"Ensure the existence of ",(0,r.kt)("inlineCode",{parentName:"li"},"LICENSE")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"NOTICE")," files."),(0,r.kt)("li",{parentName:"ul"},"Verify that the year in the ",(0,r.kt)("inlineCode",{parentName:"li"},"NOTICE")," file is correct."),(0,r.kt)("li",{parentName:"ul"},"Verify that only text files exist and there are no binary files."),(0,r.kt)("li",{parentName:"ul"},"Ensure that all files begin with the ASF license (use ",(0,r.kt)("inlineCode",{parentName:"li"},"license-eye header check")," command of the ",(0,r.kt)("inlineCode",{parentName:"li"},"skywalking-eyes")," tool for verification)."),(0,r.kt)("li",{parentName:"ul"},"Ensure successful compilation, passing unit tests (",(0,r.kt)("inlineCode",{parentName:"li"},"./gradlew build"),") (currently supporting JAVA 8/gradle 7.0/idea 2021.1.1 and above)."),(0,r.kt)("li",{parentName:"ul"},"Check for any redundant files or folders, such as empty folders.")),(0,r.kt)("h3",{id:"3-check-the-file-content-of-the-binary-package"},"3. Check the file content of the binary package"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Ensure the existence of ",(0,r.kt)("inlineCode",{parentName:"li"},"LICENSE")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"NOTICE")," files."),(0,r.kt)("li",{parentName:"ul"},"Verify that the year in the ",(0,r.kt)("inlineCode",{parentName:"li"},"NOTICE")," file is correct."),(0,r.kt)("li",{parentName:"ul"},"Ensure that all text files begin with the ASF license (use ",(0,r.kt)("inlineCode",{parentName:"li"},"license-eye header check")," command of the ",(0,r.kt)("inlineCode",{parentName:"li"},"skywalking-eyes")," tool for verification)."),(0,r.kt)("li",{parentName:"ul"},"According to the ",(0,r.kt)("a",{parentName:"li",href:"https://apache.org/legal/resolved.html"},"ASF 3RD PARTY LICENSE POLICY"),", check the licenses of third-party dependencies:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Ensure third-party dependencies' licenses are compatible with Apache-2.0 (run the ",(0,r.kt)("inlineCode",{parentName:"li"},"checkDeniedLicense")," task, focusing on the compatibility of newly added license files under the ",(0,r.kt)("inlineCode",{parentName:"li"},"tools/dist-license")," directory)."),(0,r.kt)("li",{parentName:"ul"},"Ensure all third-party dependencies' licenses are declared in the ",(0,r.kt)("inlineCode",{parentName:"li"},"LICENSE")," file."),(0,r.kt)("li",{parentName:"ul"},"Ensure the complete versions of dependency licenses are in the ",(0,r.kt)("inlineCode",{parentName:"li"},"licenses")," directory (pay attention to the warning logs of the ",(0,r.kt)("inlineCode",{parentName:"li"},"generateDistLicense")," task and supplement the license content of outdated artifacts)."),(0,r.kt)("li",{parentName:"ul"},"If the dependency is under the Apache license and there is a ",(0,r.kt)("inlineCode",{parentName:"li"},"NOTICE")," file, include these ",(0,r.kt)("inlineCode",{parentName:"li"},"NOTICE")," files' content in EventMesh's ",(0,r.kt)("inlineCode",{parentName:"li"},"NOTICE")," file.")))),(0,r.kt)("h2",{id:"initiates-a-vote"},"Initiates a vote"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"EventMesh has graduated from incubation and only needs to be voted by the community")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"EventMesh community vote, send email to: ",(0,r.kt)("inlineCode",{parentName:"li"},"dev@eventmesh.apache.org")),(0,r.kt)("li",{parentName:"ul"},"In ${Your EventMesh Release Manager} in the body of the community voting email, fill in the person responsible for this release, usually the sender of the email")),(0,r.kt)("h3",{id:"1-eventmesh-community-voting-stage"},"1. EventMesh community voting stage"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"The EventMesh community votes, send a voting email to ",(0,r.kt)("inlineCode",{parentName:"li"},"dev@eventmesh.apache.org"),". PMC needs to check the correctness of the version according to the document before voting. After at least 72 hours and counting 3 ",(0,r.kt)("inlineCode",{parentName:"li"},"+1 PMC member")," votes, you can enter the next stage of voting."),(0,r.kt)("li",{parentName:"ol"},"Announce the voting result, and send the voting result email to ",(0,r.kt)("inlineCode",{parentName:"li"},"dev@eventmesh.apache.org"),".")),(0,r.kt)("h3",{id:"2-eventmesh-community-voting-template"},"2. EventMesh community voting template"),(0,r.kt)("p",null,"Title\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"[VOTE] Release Apache EventMesh ${release_version} ${rc_version}\n")),(0,r.kt)("p",null,"Content\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Hello EventMesh Community,\n\n    This is a call for vote to release Apache EventMesh version ${release_version}-${rc_version}.\n\n    Release notes:\n    https://github.com/apache/eventmesh/releases/tag/v${release_version}-${rc_version}\n\n    The release candidates:\n        https://dist.apache.org/repos/dist/dev/eventmesh/${release_version}-${rc_version}/\n\n    Maven artifacts are available in a staging repository at:\n    https://repository.apache.org/content/repositories/orgapacheeventmesh-{staging-id}\n\n    Git tag for the release:\n    https://github.com/apache/eventmesh/tree/v${release_version}-${rc_version}\n\n    Keys to verify the Release Candidate:\n    https://downloads.apache.org/eventmesh/KEYS\n\n    Hash for the release tag:\n    #hashCode of this release tag\n\n    GPG user ID:\n    ${YOUR.GPG.USER.ID}\n\n    The vote will be open for at least 72 hours or until necessary number of votes are reached.\n\n    Please vote accordingly:\n\n    [ ] +1 approve\n\n    [ ] +0 no opinion\n\n    [ ] -1 disapprove with the reason\n\n    Checklist for reference:\n\n    [ ] Download links are valid.\n\n    [ ] Checksums and PGP signatures are valid.\n\n    [ ] Source code distributions have correct names matching the current release.\n\n    [ ] LICENSE and NOTICE files are correct for each EventMesh repo.\n\n    [ ] All files have license headers if necessary.\n\n    [ ] No compiled archives bundled in source archive.\n\n    More detail checklist  please refer:\n    https://cwiki.apache.org/confluence/display/INCUBATOR/Incubator+Release+Checklist\n\nThanks,\n${Your EventMesh Release Manager}\n")),(0,r.kt)("h3",{id:"3-announcing-voting-results-template"},"3. Announcing voting results template"),(0,r.kt)("p",null,"Title\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"[RESULT][VOTE] Release Apache EventMesh ${release_version} ${rc_version}\n")),(0,r.kt)("p",null,"Content\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Hello Apache EventMesh PMC and Community,\n\n    The vote closes now as 72hr have passed. The vote PASSES with\n\n    xx (+1 binding) votes from the PMC members,\n    member one\n    member two\n    member three\n    ...\n    \n    xx (+1 non-binding) votes from the rest of the developer community,\n    and no further 0 or -1 votes.\n\n    The vote thread: {vote_mail_address}\n\n    Many thanks for all people helping us with the release procedure. I will be working on publishing the artifacts soon.\n\nThank you for your support.\n${Your EventMesh Release Manager}\n")),(0,r.kt)("h2",{id:"official-release"},"Official release"),(0,r.kt)("h3",{id:"1-merging-code-branch"},"1. Merging code branch"),(0,r.kt)("p",null,"Merge the changes of the ",(0,r.kt)("inlineCode",{parentName:"p"},"${release_version}-prepare")," branch to the ",(0,r.kt)("inlineCode",{parentName:"p"},"master")," branch, delete the ",(0,r.kt)("inlineCode",{parentName:"p"},"release")," branch after the merge is complete"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ git checkout master\n$ git merge origin/${release_version}-prepare\n$ git pull\n$ git push origin master\n$ git push --delete origin ${release_version}-prepare\n$ git branch -d ${release_version}-prepare\n")),(0,r.kt)("h3",{id:"2-migrating-source-and-binary-packages"},"2. Migrating source and binary packages"),(0,r.kt)("p",null,"Move source and binary packages from the svn ",(0,r.kt)("inlineCode",{parentName:"p"},"dev")," directory to the ",(0,r.kt)("inlineCode",{parentName:"p"},"release")," directory"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'$ svn mv https://dist.apache.org/repos/dist/dev/eventmesh/${release_version}-${rc_version} https://dist.apache.org/repos/dist/release/eventmesh/ -m "transfer packages for ${release_version}-${rc_version}" #Move source and binary packages\n$ svn delete https://dist.apache.org/repos/dist/release/eventmesh/KEYS -m "delete KEYS" #Clear the KEYS in the original release directory\n$ svn cp https://dist.apache.org/repos/dist/dev/eventmesh/KEYS https://dist.apache.org/repos/dist/release/eventmesh/ -m "transfer KEYS for ${release_version}-${rc_version}" #Copy dev directory KEYS to release directory\n')),(0,r.kt)("h3",{id:"3-confirm-that-the-packages-under-dev-and-release-are-correct"},"3. Confirm that the packages under dev and release are correct"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Confirmed that ",(0,r.kt)("inlineCode",{parentName:"li"},"${release_version}-${rc_version}")," under ",(0,r.kt)("a",{parentName:"li",href:"https://dist.apache.org/repos/dist/dev/eventmesh/"},"dev")," has been removed"),(0,r.kt)("li",{parentName:"ul"},"Delete the release package of the previous version under the directory ",(0,r.kt)("a",{parentName:"li",href:"https://dist.apache.org/repos/dist/release/eventmesh/"},"release"),", these packages will be automatically saved in ","[here]","(https:/ /archive.apache.org/dist/eventmesh/)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'$ svn delete https://dist.apache.org/repos/dist/release/eventmesh/${last_release_version} -m "Delete ${last_release_version}"\n')),(0,r.kt)("h3",{id:"4-publish-releases-in-the-apache-staging-repository"},"4. Publish releases in the Apache Staging repository"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Log in to ",(0,r.kt)("a",{parentName:"li",href:"http://repository.apache.org"},"http://repository.apache.org"),", log in with your Apache account"),(0,r.kt)("li",{parentName:"ul"},"Click Staging repositories on the left,"),(0,r.kt)("li",{parentName:"ul"},"Search for the EventMesh keyword, select the warehouse you uploaded recently, and the warehouse specified in the voting email"),(0,r.kt)("li",{parentName:"ul"},"Click the ",(0,r.kt)("inlineCode",{parentName:"li"},"Release")," button above, this process will perform a series of checks")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"It usually takes 24 hours for the warehouse to synchronize to other data sources")),(0,r.kt)("h3",{id:"5-github-version-release"},"5. GitHub version release"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Tag the commit (on which the vote happened) with the release version without ",(0,r.kt)("inlineCode",{parentName:"p"},"-${RELEASE_CANDIDATE}"),". such as: after a successful vote on ",(0,r.kt)("inlineCode",{parentName:"p"},"v1.2-rc5"),", the hash will be tagged again with ",(0,r.kt)("inlineCode",{parentName:"p"},"v1.2")," only.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click ",(0,r.kt)("inlineCode",{parentName:"p"},"Edit")," on the ",(0,r.kt)("inlineCode",{parentName:"p"},"${release_version}")," version of the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/apache/eventmesh/releases"},"GitHub Releases")," page to edit the version number and version description, and click ",(0,r.kt)("inlineCode",{parentName:"p"},"Publish release")))),(0,r.kt)("h3",{id:"6-update-download-page"},"6. Update download page"),(0,r.kt)("p",null,"After waiting and confirming that the new release version is synchronized to the Apache mirror, update the following page:"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://eventmesh.apache.org/download/"},"https://eventmesh.apache.org/download/")),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://eventmesh.apache.org/zh/download/"},"https://eventmesh.apache.org/zh/download/")),(0,r.kt)("p",null,"Download links for GPG signature files and hash verification files should use this prefix\uff1a",(0,r.kt)("inlineCode",{parentName:"p"},"https://downloads.apache.org/eventmesh/")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note: The project download link should use ",(0,r.kt)("a",{parentName:"p",href:"https://www.apache.org/dyn/closer.lua"},"https://www.apache.org/dyn/closer.lua")," instead of closer.cgi or mirrors.cgi")),(0,r.kt)("h3",{id:"7-announce-version-is-released"},"7. Announce version is released"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Please make sure that the Apache Staging warehouse has been released successfully, usually after 24 hours of this step.")),(0,r.kt)("p",null,"Email to ",(0,r.kt)("inlineCode",{parentName:"p"},"dev@eventmesh.apache.org")," \u3001 ",(0,r.kt)("inlineCode",{parentName:"p"},"announce@apache.org")),(0,r.kt)("p",null,"Title\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"[ANNOUNCE] Apache EventMesh ${release_version} available\n")),(0,r.kt)("p",null,"Content\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Hi all,\n\nApache EventMesh Team is glad to announce the new release of Apache EventMesh ${release_version}.\n\nApache EventMesh is a dynamic cloud-native eventing infrastructure used to decouple the application and backend middleware layer, which supports a wide range of use cases that encompass complex multi-cloud, widely distributed topologies using diverse technology stacks.\n\nDownload Links: https://eventmesh.apache.org/projects/eventmesh/download/\n\nRelease Notes: https://eventmesh.apache.org/events/release-notes/v${release_version}/\n\nWebsite: https://eventmesh.apache.org/\n\nEventMesh Resources:\n- Issue: https://github.com/apache/eventmesh/issues\n- Mailing list: dev@eventmesh.apache.org\n\n\nApache EventMesh Team\n")))}d.isMDXComponent=!0}}]);