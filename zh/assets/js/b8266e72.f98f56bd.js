"use strict";(self.webpackChunkincubator_eventmesh_site=self.webpackChunkincubator_eventmesh_site||[]).push([[2887],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>f});var o=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=o.createContext({}),c=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=c(e.components);return o.createElement(l.Provider,{value:n},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},p=o.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(t),p=r,f=d["".concat(l,".").concat(p)]||d[p]||h[p]||a;return t?o.createElement(f,i(i({ref:n},u),{},{components:t})):o.createElement(f,i({ref:n},u))}));function f(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,i=new Array(a);i[0]=p;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<a;c++)i[c]=t[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}p.displayName="MDXCreateElement"},2882:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var o=t(7462),r=(t(7294),t(3905));const a={},i=void 0,s={unversionedId:"design-document/webhook",id:"design-document/webhook",title:"webhook",description:"Webhook usage process",source:"@site/docs/design-document/14-webhook.md",sourceDirName:"design-document",slug:"/design-document/webhook",permalink:"/zh/docs/design-document/webhook",draft:!1,editUrl:"https://github.com/apache/incubator-eventmesh-site/edit/master/docs/design-document/14-webhook.md",tags:[],version:"current",sidebarPosition:14,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Collect Trace with Jaeger",permalink:"/zh/docs/design-document/jaeger"}},l={},c=[{value:"Webhook usage process",id:"webhook-usage-process",level:2},{value:"The first step: Configure webhook related information in eventmesh and start",id:"the-first-step-configure-webhook-related-information-in-eventmesh-and-start",level:4},{value:"Configuration",id:"configuration",level:5},{value:"The second step: Add webhook configuration information",id:"the-second-step-add-webhook-configuration-information",level:4},{value:"Add webhook config",id:"add-webhook-config",level:5},{value:"delete webhook config",id:"delete-webhook-config",level:5},{value:"select WebHookConfig by callbackPath",id:"select-webhookconfig-by-callbackpath",level:5},{value:"\u901a\u8fc7manufacturer\u67e5\u8be2WebHookConfig\u5217\u8868",id:"\u901a\u8fc7manufacturer\u67e5\u8be2webhookconfig\u5217\u8868",level:5},{value:"The third step: Check if the configuration is successful",id:"the-third-step-check-if-the-configuration-is-successful",level:4},{value:"The fourth step: Configure the consumer of cloudevent",id:"the-fourth-step-configure-the-consumer-of-cloudevent",level:4},{value:"The fifth step: Configure webhook related information in the manufacturer",id:"the-fifth-step-configure-webhook-related-information-in-the-manufacturer",level:4},{value:"Manufacturer&#39;s webhook operation instructions",id:"manufacturers-webhook-operation-instructions",level:2},{value:"github sign up",id:"github-sign-up",level:3},{value:"The first step: Enter the corresponding project",id:"the-first-step-enter-the-corresponding-project",level:4},{value:"The second step: click setting",id:"the-second-step-click-setting",level:4},{value:"The third step: click Webhooks",id:"the-third-step-click-webhooks",level:4},{value:"The fourth step: Click on Add webhook",id:"the-fourth-step-click-on-add-webhook",level:4},{value:"The fifth step: Fill in the webhook information",id:"the-fifth-step-fill-in-the-webhook-information",level:4}],u={toc:c};function d(e){let{components:n,...a}=e;return(0,r.kt)("wrapper",(0,o.Z)({},u,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"webhook-usage-process"},"Webhook usage process"),(0,r.kt)("h4",{id:"the-first-step-configure-webhook-related-information-in-eventmesh-and-start"},"The first step: Configure webhook related information in eventmesh and start"),(0,r.kt)("h5",{id:"configuration"},"Configuration"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"# Whether to start the webhook admin service\neventMesh.webHook.admin.start=true\n\n# webhook event configuration storage mode. But currently only supports file and nacos\neventMesh.webHook.operationMode=file\n\n# The file path of fileMode. If you write #{eventMeshHome}, in the eventMesh root directory\neventMesh.webHook.fileMode.filePath= #{eventMeshHome}/webhook\n\n# The nacos storage mode. The configuration naming rule is eventMesh.webHook.nacosMode.{nacos native configuration key} For the specific configuration, please see [nacos github api](https://github.com/alibaba/nacos/blob/develop/api/src/main/java /com/alibaba/nacos/api/SystemPropertyKeyConst.java)\n## address of nacos\neventMesh.webHook.nacosMode.serverAddr=127.0.0.1:8848\n\n# webhook eventcloud send mode. Same as eventMesh.connector.plugin.type configuration\neventMesh.webHook.producer.connector=standalone\n")),(0,r.kt)("h4",{id:"the-second-step-add-webhook-configuration-information"},"The second step: Add webhook configuration information"),(0,r.kt)("p",null,"Configuration information description"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-java"},'   /**\n    * The path called by the manufacturer. Manufacturer event call address, [http or https]://[domain or IP]:[port]/webhook/[callbackPath]\n    * for example: http://127.0.0.1:10504/webhook/test/event , The full url needs to be filled in the manufacturer call input\n    * callbackPath is the only\n    */\n    private String callbackPath;\n\n    /**\n     * manufacturer name, like github\n     */\n    private String manufacturerName;\n\n    /**\n     * webhook event name, like rep-push\n     */\n    private String manufacturerEventName;\n\n    /**\n     * http header content type\n     */\n    private String contentType = "application/json";\n\n    /**\n     * description of this WebHookConfig\n     */\n    private String description;\n\n    /**\n     * secret key, for authentication\n     */\n    private String secret;\n\n    /**\n     * userName, for HTTP authentication\n     */\n    private String userName;\n\n    /**\n     * password, for HTTP authentication\n     */\n    private String password;\n\n\n    /**\n     * roll out event name, like topic to mq\n     */\n    private String cloudEventName;\n\n    /**\n     * roll out data format -> CloudEvent serialization mode\n     * If HTTP protocol is used, the request header contentType needs to be marked\n     */\n    private String dataContentType = "application/json";;\n\n    /**\n     * source of event\n     */\n    private String cloudEventSource;\n\n    /**\n     * id of cloudEvent, like uuid/manufacturerEventId\n     */\n    private String cloudEventIdGenerateMode;\n\n')),(0,r.kt)("h5",{id:"add-webhook-config"},"Add webhook config"),(0,r.kt)("p",null,"path: /webhook/insertWebHookConfig\nmethod: POST\ncontentType: application/json"),(0,r.kt)("p",null,"input params:\n| field | desc | type |\u3000necessary | default\u3000|\n| -- | -- | -- | -- | -- |\n| callbackPath | call address, unique address | string | Y\u3000| null\u3000|\n| manufacturerName | manufacturer name | string | Y\u3000| null\u3000|\n| manufacturerEventName | manufacturer EventName  | string | Y\u3000| null\u3000|\n| contentType | http connettype | string | N\u3000| application/json\u3000|\n| description | configuration instructions | string | N\u3000| null\u3000|\n| secret | signature string | string | N\u3000| null\u3000|\n| userName | username | string | N\u3000| null\u3000|\n| password | password | string | N\u3000| null\u3000|\n| cloudEventName | cloudEvent name  | string | Y\u3000| null\u3000|\n| cloudEventSource | cloudEvent source | string | Y\u3000| null\u3000|\n| cloudEventIdGenerateMode | cloudEvent event object identification method, uuid or event id  | string | N manufacturerEventId\u3000|"),(0,r.kt)("p",null,"E.g:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "callbackPath":"/webhook/github/eventmesh/all",\n    "manufacturerName":"github",\n    "manufacturerEventName":"all",\n    "secret":"eventmesh",\n    "cloudEventName":"github-eventmesh",\n    "cloudEventSource":"github"\n}\n\n')),(0,r.kt)("p",null,"Output params: 1 for success, 0 for failure"),(0,r.kt)("h5",{id:"delete-webhook-config"},"delete webhook config"),(0,r.kt)("p",null,"path: /webhook/deleteWebHookConfig\nmethod: POST\ncontentType\uff1a application/json"),(0,r.kt)("p",null,"input params:\n| field | desc | type |\u3000necessary | default\u3000|\n| -- | -- | -- | -- | -- |\n| callbackPath | call address, unique address | string | Y\u3000| null\u3000|"),(0,r.kt)("p",null,"E.g:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "callbackPath":"/webhook/github/eventmesh/all"\n}\n\n')),(0,r.kt)("p",null,"Output params: 1 for success, 0 for failure"),(0,r.kt)("h5",{id:"select-webhookconfig-by-callbackpath"},"select WebHookConfig by callbackPath"),(0,r.kt)("p",null,"path: /webhook/queryWebHookConfigById\nmethod: POST\ncontentType\uff1a application/json"),(0,r.kt)("p",null,"input params:\n| field | desc | type |\u3000necessary | default\u3000|\n| -- | -- | -- | -- | -- |\n| callbackPath | call address, unique address | string | Y\u3000| null\u3000|"),(0,r.kt)("p",null,"E.g:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "callbackPath":"/webhook/github/eventmesh/all"\n}\n\n')),(0,r.kt)("p",null,"Output params:\n| field | desc | type |\u3000necessary | default\u3000|\n| -- | -- | -- | -- | -- |\n| callbackPath | call address, unique address | string | Y\u3000| null\u3000|\n| manufacturerName | manufacturer name | string | Y\u3000| null\u3000|\n| manufacturerEventName | manufacturer event name | string | Y\u3000| null\u3000|\n| contentType | http connettype | string | N\u3000| application/json\u3000|\n| description | configuration instructions | string | N\u3000| null\u3000|\n| secret | signature key | string | N\u3000| null\u3000|\n| userName | user name | string | N\u3000| null\u3000|\n| password | password | string | N\u3000| null\u3000|\n| cloudEventName | cloudEvent name | string | Y\u3000| null\u3000|\n| cloudEventSource | cloudEvent source | string | Y\u3000| null\u3000|\n| cloudEventIdGenerateMode | cloudEvent event object identification method, uuid or event id | string | N\u3000| manufacturerEventId\u3000|"),(0,r.kt)("h5",{id:"\u901a\u8fc7manufacturer\u67e5\u8be2webhookconfig\u5217\u8868"},"\u901a\u8fc7manufacturer\u67e5\u8be2WebHookConfig\u5217\u8868"),(0,r.kt)("p",null,"path: /webhook/queryWebHookConfigByManufacturer\nmethod: POST\ncontentType\uff1a application/json"),(0,r.kt)("p",null,"input params:\n| field | desc | type |\u3000necessary | default\u3000|\n| -- | -- | -- | -- | -- |\n| manufacturerName | manufacturer name | string | Y\u3000| null\u3000|"),(0,r.kt)("p",null,"E.g:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "manufacturerName":"github"\n}\n\n')),(0,r.kt)("p",null,"Output params:\n| field | desc | type |\u3000necessary | default\u3000|\n| -- | -- | -- | -- | -- |\n| callbackPath | call address, unique address | string | Y\u3000| null\u3000|\n| manufacturerName | manufacturer name | string | Y\u3000| null\u3000|\n| manufacturerEventName | manufacturer event name | string | Y\u3000| null\u3000|\n| contentType | http connettype | string | N\u3000| application/json\u3000|\n| description | configuration instructions | string | N\u3000| null\u3000|\n| secret | signature key | string | N\u3000| null\u3000|\n| userName | user name | string | N\u3000| null\u3000|\n| password | password | string | N\u3000| null\u3000|\n| cloudEventName | cloudEvent name | string | Y\u3000| null\u3000|\n| cloudEventSource | cloudEvent source | string | Y\u3000| null\u3000|\n| cloudEventIdGenerateMode | cloudEvent event object identification method, uuid or event id  | string | N\u3000| manufacturerEventId\u3000|"),(0,r.kt)("h4",{id:"the-third-step-check-if-the-configuration-is-successful"},"The third step: Check if the configuration is successful"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"file storage mode. Please go to the eventMesh.webHook.fileMode.filePath directory to view. filename callbackPath."),(0,r.kt)("li",{parentName:"ol"},"nacos storage mode. Please go to the nacos service configured by eventMesh.webHook.nacosMode.serverAddr to see.")),(0,r.kt)("h4",{id:"the-fourth-step-configure-the-consumer-of-cloudevent"},"The fourth step: Configure the consumer of cloudevent"),(0,r.kt)("h4",{id:"the-fifth-step-configure-webhook-related-information-in-the-manufacturer"},"The fifth step: Configure webhook related information in the manufacturer"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"For manufacturer's operation, please refer to ","[Manufacturer's webhook operation instructions]"," .")),(0,r.kt)("h2",{id:"manufacturers-webhook-operation-instructions"},"Manufacturer's webhook operation instructions"),(0,r.kt)("h3",{id:"github-sign-up"},"github sign up"),(0,r.kt)("h4",{id:"the-first-step-enter-the-corresponding-project"},"The first step: Enter the corresponding project"),(0,r.kt)("h4",{id:"the-second-step-click-setting"},"The second step: click setting"),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(6157).Z,width:"1966",height:"132"})),(0,r.kt)("h4",{id:"the-third-step-click-webhooks"},"The third step: click Webhooks"),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(1374).Z,width:"664",height:"714"})),(0,r.kt)("h4",{id:"the-fourth-step-click-on-add-webhook"},"The fourth step: Click on Add webhook"),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(647).Z,width:"1664",height:"400"})),(0,r.kt)("h4",{id:"the-fifth-step-fill-in-the-webhook-information"},"The fifth step: Fill in the webhook information"),(0,r.kt)("p",null,(0,r.kt)("img",{src:t(2186).Z,width:"664",height:"714"})),(0,r.kt)("p",null,"Payload URL: Service address and pahts. ","[http or https]","://","[domain or IP]",":","[port]","/webhook/","[callbackPath]","\nContent type: http header content type\nsecret: signature string"))}d.isMDXComponent=!0},647:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/webhook-github-add-1330a5759addb9b624ec3c5ffc32bcb8.png"},2186:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/webhook-github-info-8f08530fcf0f98859e5d1697049eec18.png"},6157:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/webhook-github-setting-27fa2024d0625a7443957776ecbc7e3a.png"},1374:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/images/webhook-github-webhooks-8f08530fcf0f98859e5d1697049eec18.png"}}]);